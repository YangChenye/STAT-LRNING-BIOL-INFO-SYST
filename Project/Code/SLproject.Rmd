---
title: "projecttest"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
install.packages("dplyr")

```

```{r tread}
library(RWeka)

data_1600_accel_phone=read.arff(file(description="C:/Users/zx2269/Desktop/wisdm-dataset/arff_files/phone/accel/data_1600_accel_phone.arff"))

data_1600_accel_phone$type='accel_phone'


data_1600_accel_phone
```

```{r tread}
library(RWeka)
A11=paste("F:/wisdm-dataset/arff_files/phone/accel/data_160",1:9,'_accel_phone.arff',sep="")
A12=paste("F:/wisdm-dataset/arff_files/phone/accel/data_16",21:50,'_accel_phone.arff',sep="")
A1=c(A11,A12)
N11=paste("data_160",1:9,'_accel_phone_origin',sep="")
N12=paste("data_16",10:39,'_accel_phone_origin',sep="")
N1=c(N11,N12)
for (i in 1:39){
  assign(N1[i],read.arff(file(description=A1[i])))
}


A21=paste("F:/wisdm-dataset/arff_files/phone/gyro/data_160",1:9,'_gyro_phone.arff',sep="")
A22=paste("F:/wisdm-dataset/arff_files/phone/gyro/data_16",21:50,'_gyro_phone.arff',sep="")
A2=c(A21,A22)
N21=paste("data_160",1:9,'_gyro_phone_origin',sep="")
N22=paste("data_16",10:39,'_gyro_phone_origin',sep="")
N2=c(N21,N22)
for (i in 1:39){
  assign(N2[i],read.arff(file(description=A2[i])))
}

A31=paste("F:/wisdm-dataset/arff_files/watch/accel/data_160",1:9,'_accel_watch.arff',sep="")
A32=paste("F:/wisdm-dataset/arff_files/watch/accel/data_16",21:50,'_accel_watch.arff',sep="")
A3=c(A31,A32)
N31=paste("data_160",1:9,'_accel_watch_origin',sep="")
N32=paste("data_16",10:39,'_accel_watch_origin',sep="")
N3=c(N31,N32)
for (i in 1:39){
  assign(N3[i],read.arff(file(description=A3[i])))
}

A41=paste("F:/wisdm-dataset/arff_files/watch/gyro/data_160",1:9,'_gyro_watch.arff',sep="")
A42=paste("F:/wisdm-dataset/arff_files/watch/gyro/data_16",21:50,'_gyro_watch.arff',sep="")
A4=c(A41,A42)
N41=paste("data_160",1:9,'_gyro_watch_origin',sep="")
N42=paste("data_16",10:39,'_gyro_watch_origin',sep="")
N4=c(N41,N42)
for (i in 1:39){
  assign(N4[i],read.arff(file(description=A4[i])))
}
```



```{r tdiv}
library(ISLR)
library(caret)

set.seed(2)
ACTIVITY<-c('A','B','C','D','E','F','G','H','I','J','K','L','M','O','P','Q','R','S')
for (i in 1:9){
    sample_train<-createDataPartition(y=get(paste("data_160",i,'_accel_phone_origin',sep=""))$ACTIVITY,p=0.5,list=FALSE)
    assign(paste("data_160",i,'_accel_phone_train',sep=""),get(paste("data_160",i,'_accel_phone_origin',sep=""))[sample_train,])
    assign(paste("data_160",i,'_accel_phone_test',sep=""),get(paste("data_160",i,'_accel_phone_origin',sep=""))[sample_train,])
    sample_train<-createDataPartition(y=get(paste("data_160",i,'_accel_phone_origin',sep=""))$ACTIVITY,p=0.3,list=FALSE)
    assign(paste("data_160",i,'_accel_phone_other',sep=""),get(paste("data_160",i,'_accel_phone_origin',sep=""))[sample_train,])

  
    sample_train<-createDataPartition(y=get(paste("data_160",i,'_gyro_phone_origin',sep=""))$ACTIVITY,p=0.5,list=FALSE)
    assign(paste("data_160",i,'_gyro_phone_train',sep=""),get(paste("data_160",i,'_gyro_phone_origin',sep=""))[sample_train,])
    assign(paste("data_160",i,'_gyro_phone_test',sep=""),get(paste("data_160",i,'_gyro_phone_origin',sep=""))[sample_train,])
    sample_train<-createDataPartition(y=get(paste("data_160",i,'_gyro_phone_origin',sep=""))$ACTIVITY,p=0.3,list=FALSE)
    assign(paste("data_160",i,'_gyro_phone_other',sep=""),get(paste("data_160",i,'_gyro_phone_origin',sep=""))[sample_train,])

    
    sample_train<-createDataPartition(y=get(paste("data_160",i,'_accel_watch_origin',sep=""))$ACTIVITY,p=0.5,list=FALSE)
    assign(paste("data_160",i,'_accel_watch_train',sep=""),get(paste("data_160",i,'_accel_watch_origin',sep=""))[sample_train,])
    assign(paste("data_160",i,'_accel_watch_test',sep=""),get(paste("data_160",i,'_accel_watch_origin',sep=""))[sample_train,])
    sample_train<-createDataPartition(y=get(paste("data_160",i,'_accel_watch_origin',sep=""))$ACTIVITY,p=0.3,list=FALSE)
    assign(paste("data_160",i,'_accel_watch_other',sep=""),get(paste("data_160",i,'_accel_watch_origin',sep=""))[sample_train,])

    
    sample_train<-createDataPartition(y=get(paste("data_160",i,'_gyro_watch_origin',sep=""))$ACTIVITY,p=0.5,list=FALSE)
    assign(paste("data_160",i,'_gyro_watch_train',sep=""),get(paste("data_160",i,'_gyro_watch_origin',sep=""))[sample_train,])
    assign(paste("data_160",i,'_gyro_watch_test',sep=""),get(paste("data_160",i,'_gyro_watch_origin',sep=""))[sample_train,])
    sample_train<-createDataPartition(y=get(paste("data_160",i,'_gyro_watch_origin',sep=""))$ACTIVITY,p=0.3,list=FALSE)
    assign(paste("data_160",i,'_gyro_watch_other',sep=""),get(paste("data_160",i,'_gyro_watch_origin',sep=""))[sample_train,])

}

for (i in 10:39){
  sample_train<-createDataPartition(y=get(paste("data_16",i,'_accel_phone_origin',sep=""))$ACTIVITY,p=0.5,list=FALSE)
  assign(paste("data_16",i,'_accel_phone_train',sep=""),get(paste("data_16",i,'_accel_phone_origin',sep=""))[sample_train,])
  assign(paste("data_16",i,'_accel_phone_test',sep=""),get(paste("data_16",i,'_accel_phone_origin',sep=""))[sample_train,])
  sample_train<-createDataPartition(y=get(paste("data_16",i,'_accel_phone_origin',sep=""))$ACTIVITY,p=0.3,list=FALSE)
  assign(paste("data_16",i,'_accel_phone_other',sep=""),get(paste("data_16",i,'_accel_phone_origin',sep=""))[sample_train,])

  
  sample_train<-createDataPartition(y=get(paste("data_16",i,'_gyro_phone_origin',sep=""))$ACTIVITY,p=0.5,list=FALSE)
    assign(paste("data_16",i,'_gyro_phone_train',sep=""),get(paste("data_16",i,'_gyro_phone_origin',sep=""))[sample_train,])
    assign(paste("data_16",i,'_gyro_phone_test',sep=""),get(paste("data_16",i,'_gyro_phone_origin',sep=""))[sample_train,])
    sample_train<-createDataPartition(y=get(paste("data_16",i,'_gyro_phone_origin',sep=""))$ACTIVITY,p=0.3,list=FALSE)
    assign(paste("data_16",i,'_gyro_phone_other',sep=""),get(paste("data_16",i,'_gyro_phone_origin',sep=""))[sample_train,])

    
    sample_train<-createDataPartition(y=get(paste("data_16",i,'_accel_watch_origin',sep=""))$ACTIVITY,p=0.5,list=FALSE)
    assign(paste("data_16",i,'_accel_watch_train',sep=""),get(paste("data_16",i,'_accel_watch_origin',sep=""))[sample_train,])
    assign(paste("data_16",i,'_accel_watch_test',sep=""),get(paste("data_16",i,'_accel_watch_origin',sep=""))[sample_train,])
    sample_train<-createDataPartition(y=get(paste("data_16",i,'_accel_watch_origin',sep=""))$ACTIVITY,p=0.3,list=FALSE)
    assign(paste("data_16",i,'_accel_watch_other',sep=""),get(paste("data_16",i,'_accel_watch_origin',sep=""))[sample_train,])

    
    sample_train<-createDataPartition(y=get(paste("data_16",i,'_gyro_watch_origin',sep=""))$ACTIVITY,p=0.5,list=FALSE)
    assign(paste("data_16",i,'_gyro_watch_train',sep=""),get(paste("data_16",i,'_gyro_watch_origin',sep=""))[sample_train,])
    assign(paste("data_16",i,'_gyro_watch_test',sep=""),get(paste("data_16",i,'_gyro_watch_origin',sep=""))[sample_train,])
    sample_train<-createDataPartition(y=get(paste("data_16",i,'_gyro_watch_origin',sep=""))$ACTIVITY,p=0.3,list=FALSE)
    assign(paste("data_16",i,'_gyro_watch_other',sep=""),get(paste("data_16",i,'_gyro_watch_origin',sep=""))[sample_train,])
    
}



```

```{r removeorigin}
rm(list =objects(pattern='origin')) 
```



```{r phone}
Num=4
ACTIVITY<-c('A','B','C','D','E','F','G','H','I','J','K','L','M','O','P','Q','R','S')
tmp_begin<-data.frame()
for (i in ACTIVITY){
  a=1:39  
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_accel_phone_train',sep=""))
    assign('tmp_begin',df[sample(nrow(df), 90), ])
  }
  else{
    df=get(paste("data_16",Num,'_accel_phone_train',sep=""))
    assign('tmp_begin',df[sample(nrow(df), 90), ])
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_accel_phone_other',sep=""))
    df$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), df[sample(nrow(df), 30), ]))
  }
  else{
    df=get(paste("data_16",j,'_accel_phone_other',sep=""))
    df$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), df[sample(nrow(df), 30), ]))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_accel_phone_train',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_accel_phone_train',sep=""),tmp_final)
  }
  
  
  
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_accel_phone_test',sep=""))
    assign('tmp_begin',df[sample(nrow(df), 90), ])
  }
  else{
    df=get(paste("data_16",Num,'_accel_phone_test',sep=""))
    assign('tmp_begin',df[sample(nrow(df), 90), ])
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_accel_phone_other',sep=""))
    df$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), df[sample(nrow(df), 30), ]))
  }
  else{
    df=get(paste("data_16",j,'_accel_phone_other',sep=""))
    df$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), df[sample(nrow(df), 30), ]))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_accel_phone_test',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_accel_phone_test',sep=""),tmp_final)
  }
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_gyro_phone_train',sep=""))
    assign('tmp_begin',df[sample(nrow(df), 90), ])
  }
  else{
    df=get(paste("data_16",Num,'_gyro_phone_train',sep=""))
    assign('tmp_begin',df[sample(nrow(df), 90), ])
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_gyro_phone_other',sep=""))
    df$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), df[sample(nrow(df), 30), ]))
  }
  else{
    df=get(paste("data_16",j,'_gyro_phone_other',sep=""))
    df$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), df[sample(nrow(df), 30), ]))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_gyro_phone_train',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_gyro_phone_train',sep=""),tmp_final)
  }
  
  
  
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_gyro_phone_test',sep=""))
    assign('tmp_begin',df[sample(nrow(df), 90), ])
  }
  else{
    df=get(paste("data_16",Num,'_gyro_phone_test',sep=""))
    assign('tmp_begin',df[sample(nrow(df), 90), ])
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_gyro_phone_other',sep=""))
    df$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), df[sample(nrow(df), 30), ]))
  }
  else{
    df=get(paste("data_16",j,'_gyro_phone_other',sep=""))
    df$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), df[sample(nrow(df), 30), ]))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_gyro_phone_test',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_gyro_phone_test',sep=""),tmp_final)
  }

  
}  

```


```{r watch}
ACTIVITY<-c('A','B','C','D','E','F','G','H','I','J','K','L','M','O','P','Q','R','S')
tmp_begin<-data.frame()
for (i in ACTIVITY){
  a=1:39  
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_accel_watch_train',sep=""))
    assign('tmp_begin',df[sample(nrow(df), 90), ])
  }
  else{
    df=get(paste("data_16",Num,'_accel_watch_train',sep=""))
    assign('tmp_begin',df[sample(nrow(df), 90), ])
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_accel_watch_other',sep=""))
    df$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), df[sample(nrow(df), 30), ]))
  }
  else{
    df=get(paste("data_16",j,'_accel_watch_other',sep=""))
    df$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), df[sample(nrow(df), 30), ]))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_accel_watch_train',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_accel_watch_train',sep=""),tmp_final)
  }
  
  
  
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_accel_watch_test',sep=""))
    assign('tmp_begin',df[sample(nrow(df), 90), ])
  }
  else{
    df=get(paste("data_16",Num,'_accel_watch_test',sep=""))
    assign('tmp_begin',df[sample(nrow(df), 90), ])
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_accel_watch_other',sep=""))
    df$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), df[sample(nrow(df), 30), ]))
  }
  else{
    df=get(paste("data_16",j,'_accel_watch_other',sep=""))
    df$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), df[sample(nrow(df), 30), ]))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_accel_watch_test',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_accel_watch_test',sep=""),tmp_final)
  }
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_gyro_watch_train',sep=""))
    assign('tmp_begin',df[sample(nrow(df), 90), ])
  }
  else{
    df=get(paste("data_16",Num,'_gyro_watch_train',sep=""))
    assign('tmp_begin',df[sample(nrow(df), 90), ])
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_gyro_watch_other',sep=""))
    df$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), df[sample(nrow(df), 30), ]))
  }
  else{
    df=get(paste("data_16",j,'_gyro_watch_other',sep=""))
    df$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), df[sample(nrow(df), 30), ]))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_gyro_watch_train',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_gyro_watch_train',sep=""),tmp_final)
  }
  
  
  
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_gyro_watch_test',sep=""))
    assign('tmp_begin',df[sample(nrow(df), 90), ])
  }
  else{
    df=get(paste("data_16",Num,'_gyro_watch_test',sep=""))
    assign('tmp_begin',df[sample(nrow(df), 90), ])
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_gyro_watch_other',sep=""))
    df$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), df[sample(nrow(df), 30), ]))
  }
  else{
    df=get(paste("data_16",j,'_gyro_watch_other',sep=""))
    df$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), df[sample(nrow(df), 30), ]))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_gyro_watch_test',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_gyro_watch_test',sep=""),tmp_final)
  }
  
  
  
  
  
  

}  

```



```{r comb}

ACTIVITY<-c('A','B','C','D','E','F','G','H','I','J','K','L','M','O','P','Q','R','S')
tmp_begin<-data.frame()
for (i in ACTIVITY){
  a=1:39  
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_accel_watch_train',sep=""))
    df2=get(paste("data_160",Num,'_accel_phone_train',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    tmp<-rbind.data.frame(df, df2)

    assign('tmp_begin',tmp)
  }
  else{
    df=get(paste("data_16",Num,'_accel_watch_train',sep=""))
    df2=get(paste("data_16",Num,'_accel_phone_train',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    tmp<-rbind.data.frame(df, df2)

    assign('tmp_begin',tmp)
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_accel_watch_other',sep=""))
    df2=get(paste("data_160",j,'_accel_phone_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    tmp<-rbind.data.frame(df, df2)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
  else{
    df=get(paste("data_16",j,'_accel_watch_other',sep=""))
    df2=get(paste("data_16",j,'_accel_phone_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    tmp<-rbind.data.frame(df, df2)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_accel_train',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_accel_train',sep=""),tmp_final)
  }

  
  
  
  
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_gyro_watch_train',sep=""))
    df2=get(paste("data_160",Num,'_gyro_phone_train',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    tmp<-rbind.data.frame(df, df2)

    assign('tmp_begin',tmp)
  }
  else{
    df=get(paste("data_16",Num,'_gyro_watch_train',sep=""))
    df2=get(paste("data_16",Num,'_gyro_phone_train',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    tmp<-rbind.data.frame(df, df2)

    assign('tmp_begin',tmp)
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_gyro_watch_other',sep=""))
    df2=get(paste("data_160",j,'_gyro_phone_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    tmp<-rbind.data.frame(df, df2)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
  else{
    df=get(paste("data_16",j,'_gyro_watch_other',sep=""))
    df2=get(paste("data_16",j,'_gyro_phone_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    tmp<-rbind.data.frame(df, df2)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_gyro_train',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_gyro_train',sep=""),tmp_final)
  }
  
  
  
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_accel_phone_train',sep=""))
    df2=get(paste("data_160",Num,'_gyro_phone_train',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    tmp<-rbind.data.frame(df, df2)

    assign('tmp_begin',tmp)
  }
  else{
    df=get(paste("data_16",Num,'_accel_phone_train',sep=""))
    df2=get(paste("data_16",Num,'_gyro_phone_train',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    tmp<-rbind.data.frame(df, df2)

    assign('tmp_begin',tmp)
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_accel_phone_other',sep=""))
    df2=get(paste("data_160",j,'_gyro_phone_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    tmp<-rbind.data.frame(df, df2)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
  else{
    df=get(paste("data_16",j,'_accel_phone_other',sep=""))
    df2=get(paste("data_16",j,'_gyro_phone_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    tmp<-rbind.data.frame(df, df2)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_phone_train',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_phone_train',sep=""),tmp_final)
  }



  
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_accel_watch_train',sep=""))
    df2=get(paste("data_160",Num,'_gyro_watch_train',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    tmp<-rbind.data.frame(df, df2)

    assign('tmp_begin',tmp)
  }
  else{
    df=get(paste("data_16",Num,'_accel_watch_train',sep=""))
    df2=get(paste("data_16",Num,'_gyro_watch_train',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    tmp<-rbind.data.frame(df, df2)

    assign('tmp_begin',tmp)
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_accel_watch_other',sep=""))
    df2=get(paste("data_160",j,'_gyro_watch_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    tmp<-rbind.data.frame(df, df2)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
  else{
    df=get(paste("data_16",j,'_accel_watch_other',sep=""))
    df2=get(paste("data_16",j,'_gyro_watch_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    tmp<-rbind.data.frame(df, df2)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_watch_train',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_watch_train',sep=""),tmp_final)
  }
  
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_accel_watch_train',sep=""))
    df2=get(paste("data_160",Num,'_gyro_watch_train',sep=""))
    df3=get(paste("data_160",Num,'_accel_phone_train',sep=""))
    df4=get(paste("data_160",Num,'_gyro_phone_train',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    df3<-df3[sample(nrow(df3), 90), ]
    df4<-df4[sample(nrow(df4), 90), ]
    tmp<-rbind.data.frame(df, df2,df3,df4)

    assign('tmp_begin',tmp)
  }
  else{
    df=get(paste("data_16",Num,'_accel_watch_train',sep=""))
    df2=get(paste("data_16",Num,'_gyro_watch_train',sep=""))
    df3=get(paste("data_16",Num,'_accel_phone_train',sep=""))
    df4=get(paste("data_16",Num,'_gyro_phone_train',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    df3<-df3[sample(nrow(df3), 90), ]
    df4<-df4[sample(nrow(df4), 90), ]
    tmp<-rbind.data.frame(df, df2,df3,df4)

    assign('tmp_begin',tmp)
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_accel_watch_other',sep=""))
    df2=get(paste("data_160",j,'_gyro_watch_other',sep=""))
    df3=get(paste("data_160",j,'_accel_phone_other',sep=""))
    df4=get(paste("data_160",j,'_gyro_phone_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    df3<-df3[sample(nrow(df3), 30), ]
    df4<-df4[sample(nrow(df4), 30), ]
    tmp<-rbind.data.frame(df, df2,df3,df4)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
  else{
    df=get(paste("data_16",j,'_accel_watch_other',sep=""))
    df2=get(paste("data_16",j,'_gyro_watch_other',sep=""))
    df3=get(paste("data_16",j,'_accel_phone_other',sep=""))
    df4=get(paste("data_16",j,'_gyro_phone_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    df3<-df3[sample(nrow(df3), 30), ]
    df4<-df4[sample(nrow(df4), 30), ]
    tmp<-rbind.data.frame(df, df2,df3,df4)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_all_train',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_all_train',sep=""),tmp_final)
  }
  
  
  
  
  
  
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_accel_watch_test',sep=""))
    df2=get(paste("data_160",Num,'_accel_phone_test',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    tmp<-rbind.data.frame(df, df2)

    assign('tmp_begin',tmp)
  }
  else{
    df=get(paste("data_16",Num,'_accel_watch_test',sep=""))
    df2=get(paste("data_16",Num,'_accel_phone_test',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    tmp<-rbind.data.frame(df, df2)

    assign('tmp_begin',tmp)
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_accel_watch_other',sep=""))
    df2=get(paste("data_160",j,'_accel_phone_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    tmp<-rbind.data.frame(df, df2)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
  else{
    df=get(paste("data_16",j,'_accel_watch_other',sep=""))
    df2=get(paste("data_16",j,'_accel_phone_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    tmp<-rbind.data.frame(df, df2)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_accel_test',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_accel_test',sep=""),tmp_final)
  }
  
  
  
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_gyro_watch_test',sep=""))
    df2=get(paste("data_160",Num,'_gyro_phone_test',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    tmp<-rbind.data.frame(df, df2)

    assign('tmp_begin',tmp)
  }
  else{
    df=get(paste("data_16",Num,'_gyro_watch_test',sep=""))
    df2=get(paste("data_16",Num,'_gyro_phone_test',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    tmp<-rbind.data.frame(df, df2)

    assign('tmp_begin',tmp)
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_gyro_watch_other',sep=""))
    df2=get(paste("data_160",j,'_gyro_phone_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    tmp<-rbind.data.frame(df, df2)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
  else{
    df=get(paste("data_16",j,'_gyro_watch_other',sep=""))
    df2=get(paste("data_16",j,'_gyro_phone_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    tmp<-rbind.data.frame(df, df2)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_gyro_test',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_gyro_test',sep=""),tmp_final)
  }
  
  
  
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_accel_phone_test',sep=""))
    df2=get(paste("data_160",Num,'_gyro_phone_test',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    tmp<-rbind.data.frame(df, df2)

    assign('tmp_begin',tmp)
  }
  else{
    df=get(paste("data_16",Num,'_accel_phone_test',sep=""))
    df2=get(paste("data_16",Num,'_gyro_phone_test',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    tmp<-rbind.data.frame(df, df2)

    assign('tmp_begin',tmp)
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_accel_phone_other',sep=""))
    df2=get(paste("data_160",j,'_gyro_phone_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    tmp<-rbind.data.frame(df, df2)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
  else{
    df=get(paste("data_16",j,'_accel_phone_other',sep=""))
    df2=get(paste("data_16",j,'_gyro_phone_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    tmp<-rbind.data.frame(df, df2)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_phone_test',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_phone_test',sep=""),tmp_final)
  }



  
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_accel_watch_test',sep=""))
    df2=get(paste("data_160",Num,'_gyro_watch_test',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    tmp<-rbind.data.frame(df, df2)

    assign('tmp_begin',tmp)
  }
  else{
    df=get(paste("data_16",Num,'_accel_watch_test',sep=""))
    df2=get(paste("data_16",Num,'_gyro_watch_test',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    tmp<-rbind.data.frame(df, df2)

    assign('tmp_begin',tmp)
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_accel_watch_other',sep=""))
    df2=get(paste("data_160",j,'_gyro_watch_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    tmp<-rbind.data.frame(df, df2)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
  else{
    df=get(paste("data_16",j,'_accel_watch_other',sep=""))
    df2=get(paste("data_16",j,'_gyro_watch_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    tmp<-rbind.data.frame(df, df2)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_watch_test',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_watch_test',sep=""),tmp_final)
  }
  
  random_Num=sample(a[a!=Num], 9, replace = FALSE)
  if (Num<10){
    df=get(paste("data_160",Num,'_accel_watch_test',sep=""))
    df2=get(paste("data_160",Num,'_gyro_watch_test',sep=""))
    df3=get(paste("data_160",Num,'_accel_phone_test',sep=""))
    df4=get(paste("data_160",Num,'_gyro_phone_test',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    df3<-df3[sample(nrow(df3), 90), ]
    df4<-df4[sample(nrow(df4), 90), ]
    tmp<-rbind.data.frame(df, df2,df3,df4)

    assign('tmp_begin',tmp)
  }
  else{
    df=get(paste("data_16",Num,'_accel_watch_test',sep=""))
    df2=get(paste("data_16",Num,'_gyro_watch_test',sep=""))
    df3=get(paste("data_16",Num,'_accel_phone_test',sep=""))
    df4=get(paste("data_16",Num,'_gyro_phone_test',sep=""))
    df<-df[sample(nrow(df), 90), ]
    df2<-df2[sample(nrow(df2), 90), ]
    df3<-df3[sample(nrow(df3), 90), ]
    df4<-df4[sample(nrow(df4), 90), ]
    tmp<-rbind.data.frame(df, df2,df3,df4)

    assign('tmp_begin',tmp)
  }
  tmp_final<-tmp_begin
  tmp_final$class<-1L
  
  for (j in random_Num){
    if (j<10){
    df=get(paste("data_160",j,'_accel_watch_other',sep=""))
    df2=get(paste("data_160",j,'_gyro_watch_other',sep=""))
    df3=get(paste("data_160",j,'_accel_phone_other',sep=""))
    df4=get(paste("data_160",j,'_gyro_phone_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    df3<-df3[sample(nrow(df3), 30), ]
    df4<-df4[sample(nrow(df4), 30), ]
    tmp<-rbind.data.frame(df, df2,df3,df4)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
  else{
    df=get(paste("data_16",j,'_accel_watch_other',sep=""))
    df2=get(paste("data_16",j,'_gyro_watch_other',sep=""))
    df3=get(paste("data_16",j,'_accel_phone_other',sep=""))
    df4=get(paste("data_16",j,'_gyro_phone_other',sep=""))
    df<-df[sample(nrow(df), 30), ]
    df2<-df2[sample(nrow(df2), 30), ]
    df3<-df3[sample(nrow(df3), 30), ]
    df4<-df4[sample(nrow(df4), 30), ]
    tmp<-rbind.data.frame(df, df2,df3,df4)
    tmp$class<-0L
    tmp_final<-data.frame(rbind((tmp_final), tmp))
  }
    
  }
  tmp_final$class<-as.factor(tmp_final$class)
  if (Num<10){
    assign(paste("data_160",Num,'_select_',i,'_all_test',sep=""),tmp_final)
  }
  else{
    assign(paste("data_16",Num,'_select_',i,'_all_test',sep=""),tmp_final)
  }
  
  
  
  

  

}  

```



```{r removeorigin}
#Do not need to run, just for clearing the wrong variable in environment.
#rm(list =objects(pattern='select')) 
```







```{r predict_knn}
library(ISLR)
library(caret)
library(C50)
library(pROC)
library(ROCR)
library(rpart)
library(e1071)
library(dplyr)
tmpfinal_knn_1<-c()
tmpfinal_knn_2<-c()
tmpfinal_knn_3<-c()
tmpfinal_knn_4<-c()
tmpfinal_knn_5<-c()
tmpfinal_knn_6<-c()
tmpfinal_knn_7<-c()
tmpfinal_knn_8<-c()
tmpfinal_knn_9<-c()
final_knn<-c()
if(Num<10){
for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_accel_phone_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_accel_phone_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_accel_phone_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_knn_1<-c(tmpfinal_knn_1,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmpfinal_knn_1)/18)

for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_gyro_phone_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_gyro_phone_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_gyro_phone_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_knn_2<-c(tmpfinal_knn_2,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmpfinal_knn_2)/18)

for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_accel_watch_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_accel_watch_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_accel_watch_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_knn_3<-c(tmpfinal_knn_3,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmpfinal_knn_3)/18)

for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_gyro_watch_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_gyro_watch_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_gyro_watch_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_knn_4<-c(tmpfinal_knn_4,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmpfinal_knn_4)/18)








}
if(Num>9){
  for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_accel_phone_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_accel_phone_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_accel_phone_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_knn_1<-c(tmp_final_knn_1,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmp_final_knn_1)/18)

for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_gyro_phone_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_gyro_phone_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_gyro_phone_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_knn_2<-c(tmp_final_knn_2,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmp_final_knn_2)/18)

for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_accel_watch_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_accel_watch_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_accel_watch_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_knn_3<-c(tmp_final_knn_3,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmp_final_knn_3)/18)

for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_gyro_watch_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_gyro_watch_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_gyro_watch_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_knn_4<-c(tmp_final_knn_4,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmp_final_knn_4)/18)


for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_phone_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_phone_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_phone_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_knn_5<-c(tmp_final_knn_5,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmp_final_knn_5)/18)





for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_watch_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_watch_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_watch_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_knn_6<-c(tmp_final_knn_6,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmp_final_knn_6)/18)



for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_accel_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_accel_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_accel_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_knn_7<-c(tmp_final_knn_7,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmp_final_knn_7)/18)


for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_gyro_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_gyro_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_gyro_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_knn_8<-c(tmp_final_knn_8,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmp_final_knn_8)/18)


for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_all_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_all_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_all_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_knn_9<-c(tmp_final_knn_9,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmp_final_knn_9)/18)





}


tmpfinal_knn_5<-c()
tmpfinal_knn_6<-c()
tmpfinal_knn_7<-c()
tmpfinal_knn_8<-c()
tmpfinal_knn_9<-c()

if(Num<10){

for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_phone_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_phone_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_phone_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_knn_5<-c(tmpfinal_knn_5,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmpfinal_knn_5)/18)





for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_watch_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_watch_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_watch_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_knn_6<-c(tmpfinal_knn_6,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmpfinal_knn_6)/18)



for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_accel_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_accel_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_accel_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_knn_7<-c(tmpfinal_knn_7,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmpfinal_knn_7)/18)


for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_gyro_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_gyro_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_gyro_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_knn_8<-c(tmpfinal_knn_8,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmpfinal_knn_8)/18)


for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_all_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_all_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_all_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_knn_9<-c(tmpfinal_knn_9,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmpfinal_knn_9)/18)





}



if(Num>9){
  for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_phone_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_phone_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_phone_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_knn_5<-c(tmpfinal_knn_5,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmpfinal_knn_5)/18)





for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_watch_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_watch_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_watch_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_knn_6<-c(tmpfinal_knn_6,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmpfinal_knn_6)/18)



for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_accel_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_accel_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_accel_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_knn_7<-c(tmpfinal_knn_7,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmpfinal_knn_7)/18)


for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_gyro_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_gyro_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_gyro_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_knn_8<-c(tmpfinal_knn_8,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmpfinal_knn_8)/18)


for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="knn",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_all_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_all_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_all_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_knn_9<-c(tmpfinal_knn_9,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_knn<-c(final_knn,sum(tmpfinal_knn_9)/18)


}
final_knn
```




```{r test_1}

test_1<-matrix()
test_1<-rbind(as.matrix(t(tmpfinal_knn_5)),as.matrix(t(tmpfinal_knn_6)),as.matrix(t(tmpfinal_knn_7)),as.matrix(t(tmpfinal_knn_8)),as.matrix(t(tmpfinal_knn_9)))
test_1<-t(test_1)
```
```{r test_2}

test_2<-matrix()
test_2<-rbind(as.matrix(t(tmpfinal_knn_1)),as.matrix(t(tmpfinal_knn_2)),as.matrix(t(tmpfinal_knn_3)),as.matrix(t(tmpfinal_knn_4)))
test_2<-t(test_2)
```

```{r test_3}

test_3<-matrix()
test_3<-rbind(as.matrix(t(tmpfinal_1)),as.matrix(t(tmpfinal_2)),as.matrix(t(tmpfinal_3)),as.matrix(t(tmpfinal_4)))
test_3
```

```{r test_4}

test_4<-matrix()
test_4<-rbind(as.matrix(t(tmpfinal_1)),as.matrix(t(tmpfinal_2)),as.matrix(t(tmpfinal_3)),as.matrix(t(tmpfinal_4)))
test_4
```

```{r test_5}

test_5<-matrix()
test_5<-rbind(as.matrix(t(tmpfinal_1)),as.matrix(t(tmpfinal_2)),as.matrix(t(tmpfinal_3)),as.matrix(t(tmpfinal_4)))
test_5
```

```{r test}
userScores=p_A
impostorScores=data_1601_select_A_accel_phone_test$class
calculateEqualError <- function( userScores, impostorScores ) {

  predictions <- c( userScores, impostorScores );
  labels <- c( rep( 0, length( userScores ) ),
              rep( 1, length( impostorScores ) ) );
  
  pred <- prediction( predictions, labels );

  missrates <- pred@fn[[1]] / pred@n.pos[[1]];
  farates <- pred@fp[[1]] / pred@n.neg[[1]];

  # Find the point on the ROC with miss slightly >= fa, and the point
  # next to it with miss slightly < fa.
  
  dists <- missrates - farates;
  idx1 <- which( dists == min( dists[ dists >= 0 ] ) );
  idx2 <- which( dists == max( dists[ dists < 0 ] ) );
  stopifnot( length( idx1 ) == 1 );
  stopifnot( length( idx2 ) == 1 );
  stopifnot( abs( idx1 - idx2 ) == 1 );

  
  x <- c( missrates[idx1], farates[idx1] );
  y <- c( missrates[idx2], farates[idx2] );
  a <- ( x[1] - x[2] ) / ( y[2] - x[2] - y[1] + x[1] );
  eer <- x[1] + a * ( y[1] - x[1] );

  return( eer );
}
calculateEqualError( userScores, impostorScores )
```


```{r predict_cforest}
library(ISLR)
library(caret)
library(C50)
library(pROC)
library(ROCR)
library(rpart)
library(e1071)
library(dplyr)
tmpfinal_cforest_1<-c()
tmpfinal_cforest_2<-c()
tmpfinal_cforest_3<-c()
tmpfinal_cforest_4<-c()
tmpfinal_cforest_5<-c()
tmpfinal_cforest_6<-c()
tmpfinal_cforest_7<-c()
tmpfinal_cforest_8<-c()
tmpfinal_cforest_9<-c()
final_cforest<-c()
if(Num<10){
for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_accel_phone_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_accel_phone_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_accel_phone_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_cforest_1<-c(tmpfinal_cforest_1,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmpfinal_cforest_1)/18)

for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_gyro_phone_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_gyro_phone_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_gyro_phone_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_cforest_2<-c(tmpfinal_cforest_2,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmpfinal_cforest_2)/18)

for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_accel_watch_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_accel_watch_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_accel_watch_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_cforest_3<-c(tmpfinal_cforest_3,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmpfinal_cforest_3)/18)

for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_gyro_watch_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_gyro_watch_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_gyro_watch_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_cforest_4<-c(tmpfinal_cforest_4,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmpfinal_cforest_4)/18)








}
if(Num>9){
  for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_accel_phone_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_accel_phone_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_accel_phone_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_cforest_1<-c(tmp_final_cforest_1,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmp_final_cforest_1)/18)

for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_gyro_phone_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_gyro_phone_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_gyro_phone_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_cforest_2<-c(tmp_final_cforest_2,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmp_final_cforest_2)/18)

for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_accel_watch_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_accel_watch_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_accel_watch_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_cforest_3<-c(tmp_final_cforest_3,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmp_final_cforest_3)/18)

for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_gyro_watch_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_gyro_watch_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_gyro_watch_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_cforest_4<-c(tmp_final_cforest_4,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmp_final_cforest_4)/18)


for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_phone_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_phone_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_phone_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_cforest_5<-c(tmp_final_cforest_5,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmp_final_cforest_5)/18)





for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_watch_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_watch_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_watch_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_cforest_6<-c(tmp_final_cforest_6,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmp_final_cforest_6)/18)



for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_accel_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_accel_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_accel_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_cforest_7<-c(tmp_final_cforest_7,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmp_final_cforest_7)/18)


for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_gyro_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_gyro_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_gyro_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_cforest_8<-c(tmp_final_cforest_8,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmp_final_cforest_8)/18)


for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_all_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_all_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_all_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmp_final_cforest_9<-c(tmp_final_cforest_9,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmp_final_cforest_9)/18)





}


tmpfinal_cforest_5<-c()
tmpfinal_cforest_6<-c()
tmpfinal_cforest_7<-c()
tmpfinal_cforest_8<-c()
tmpfinal_cforest_9<-c()

if(Num<10){

for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_phone_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_phone_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_phone_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_cforest_5<-c(tmpfinal_cforest_5,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmpfinal_cforest_5)/18)





for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_watch_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_watch_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_watch_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_cforest_6<-c(tmpfinal_cforest_6,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmpfinal_cforest_6)/18)



for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_accel_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_accel_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_accel_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_cforest_7<-c(tmpfinal_cforest_7,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmpfinal_cforest_7)/18)


for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_gyro_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_gyro_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_gyro_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_cforest_8<-c(tmpfinal_cforest_8,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmpfinal_cforest_8)/18)


for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_160",Num,'_select_',i,'_all_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_160",Num,'_select_',i,'_all_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_160",Num,'_select_',i,'_all_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_cforest_9<-c(tmpfinal_cforest_9,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmpfinal_cforest_9)/18)





}



if(Num>9){
  for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_phone_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_phone_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_phone_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_cforest_5<-c(tmpfinal_cforest_5,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmpfinal_cforest_5)/18)





for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_watch_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_watch_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_watch_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_cforest_6<-c(tmpfinal_cforest_6,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmpfinal_cforest_6)/18)



for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_accel_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_accel_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_accel_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_cforest_7<-c(tmpfinal_cforest_7,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmpfinal_cforest_7)/18)


for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_gyro_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_gyro_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_gyro_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_cforest_8<-c(tmpfinal_cforest_8,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmpfinal_cforest_8)/18)


for (i in ACTIVITY){
assign(paste("model",i,sep=""),train(class~.,method="cforest",metric="Accuracy",data=get(paste("data_16",Num,'_select_',i,'_all_train',sep=""))))
assign(paste("p_",i,sep=""),predict(get(paste("model",i,sep="")),get(paste("data_16",Num,'_select_',i,'_all_test',sep=""))))
assign(paste("c_",i,sep=""),table(get(paste("data_16",Num,'_select_',i,'_all_test',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted')))
assign(paste("m_",i,sep=""),confusionMatrix(get(paste("c_",i,sep=""))))
tmpfinal_cforest_9<-c(tmpfinal_cforest_9,as.numeric(get(paste("m_",i,sep=""))$overall[1]["Accuracy"]))  
  
}
final_cforest<-c(final_cforest,sum(tmpfinal_cforest_9)/18)


}
final_cforest
```




```{r store}


p_B[1]<-1
p_B[2]<-1
p_C_new<-c(1,1)
for (i in 3:(length((p_C))-2)) {
    if ((
      as.numeric(p_C)[i-1]+as.numeric(p_C)[i]+as.numeric(p_C)[i+1]+as.numeric(p_C)[i+2])>7){
      p_C_new<-c(p_C_new,1)
    }else{
      p_C_new<-c(p_C_new,2)
    }
    
}
i='C'
p_C_new<-c(p_C_new,1,1)
c_test<-table(get(paste("data_16",Num,'_select_',i,'_accel_phone_train',sep=""))$class,get(paste("p_",i,sep="")),dnn = c('Actual','Predicted'))

assign(paste("m_",'test',sep=""),confusionMatrix(get(paste("c_",'test',sep=""))))
m_test
```


if ((as.numeric(p_B)[i])>2){
      p_B_new<-c(p_B_new,1)
    }else{
      p_B_new<-c(p_B_new,0)
    }